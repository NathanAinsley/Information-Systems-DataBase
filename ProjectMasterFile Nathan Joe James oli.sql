DROP TABLE RR_PARTS_MAINTENANCE;
DROP TABLE RR_MAINTENANCE;
DROP TABLE RR_ORDER_PARTS;
DROP TABLE RR_Order;
DROP TABLE RR_Rental;
DROP TABLE RR_Bike;
DROP TABLE RR_Parts;
DROP TABLE RR_Buyer;
DROP TABLE RR_Manufacturer;
DROP TABLE RR_Employee;
DROP TABLE RR_Customer;




CREATE TABLE RR_Customer
(
    CUST_ID         NUMBER(4)       PRIMARY KEY,
    CUST_FNAME      VARCHAR(15)     NOT NULL,
    CUST_LNAME      VARCHAR(15)     NOT NULL, 
    CUST_ADDRESS    VARCHAR(20)     NOT NULL,
    CUST_POSTCODE   VARCHAR(8)      NOT NULL,
    CUST_PHONE      NUMBER(11)      NOT NULL,
    CUST_EMAIL      VARCHAR(40)     NOT NULL
    
 /* Created by Nathan */

);
CREATE TABLE RR_Employee

(
    EMPLOYEE_ID        NUMBER(4)      PRIMARY KEY,
    EMP_FORENAME       VARCHAR(15)    NOT NULL,
    EMP_SURNAME        VARCHAR(20)    NOT NULL,
    EMP_ADDRESS        VARCHAR(40)    NOT NULL,
    EMP_POSTCODE       VARCHAR(8)     NOT NULL,
    EMP_PHONE          NUMBER(11)     NOT NULL,
    EMP_EMAIL          VARCHAR(40)    NOT NULL
/* Made by Oliver Bevington */
);
CREATE TABLE RR_Manufacturer

(
    MANUFACTURER_ID         NUMBER(4)      PRIMARY KEY,
    MANUFACTURER_NAME       VARCHAR(30)     NOT NULL,
    MANUFACTURER_ADDRESS     VARCHAR(40)     NOT NULL,
    MANUFACTURER_POSTCODE   VARCHAR(8)      NOT NULL,
    MANUFACTURER_PHONE      NUMBER(12)      NOT NULL
/* Made by Joe Davies */
);
CREATE TABLE RR_Buyer

(
    BUYER_ID        NUMBER(4)      PRIMARY KEY,
    BUYER_NAME      VARCHAR(30)     NOT NULL,
    BUYER_ADDRESS   VARCHAR(40)     NOT NULL,
    BUYER_POSTCODE  VARCHAR(8)      NOT NULL,
    BUYER_PHONE     NUMBER(12)      NOT NULL
/* Made by Joe Davies */ 
);
CREATE TABLE RR_Parts

(
   PART_ID                  NUMBER(4)     PRIMARY KEY,
   PART_NAME                VARCHAR(30)    NOT NULL,
   PART_SIZE                VARCHAR(10)     NOT NULL,
   PART_MANUFACTURER_ID     NUMBER(4)     references RR_Manufacturer(MANUFACTURER_ID),
   PART_PRICE               NUMBER(10,2)      NOT NULL,
   CONSTRAINT Chk_Size CHECK (PART_SIZE = 'SMALL' OR PART_SIZE = 'MEDIUM' OR PART_SIZE = 'LARGE')
  /*made by James Brito Alvarado */ 

);
CREATE TABLE RR_Bike

(
    BIKE_ID                 NUMBER(4)          PRIMARY KEY,
    BK_MANUFACTURER_ID      NUMBER(4)          references RR_Manufacturer(MANUFACTURER_ID),
    BIKE_MODEL              VARCHAR(20)         NOT NULL,
    BIKE_SIZE               VARCHAR(20)         NOT NULL,
    BIKE_BOUGHT_PRICE       NUMBER(10,2)          NOT NULL,
    BIKE_BOUGHT_DATE        DATE                NOT NULL,
    SALE_PRICE              NUMBER(10,2)          NOT NULl,
    BIKE_AVAILABILITY       VARCHAR(3)          NOT NULL,
    BK_BUYER_ID             NUMBER(4)          references RR_Buyer(BUYER_ID),
    SALE_DATE               DATE                NOT NULL,
    CONSTRAINT Chk_bkAvailability CHECK (BIKE_AVAILABILITY = 'YES' OR BIKE_AVAILABILITY = 'NO'),
    CONSTRAINT Chk_bkSize CHECK (BIKE_SIZE = 'SMALL' OR BIKE_SIZE = 'MEDIUM' OR BIKE_SIZE = 'LARGE')

);
CREATE TABLE RR_Rental
(
    Rental_ID               NUMBER(4)      PRIMARY KEY,
    RENT_EMPLOYEE_ID        NUMBER(4)      REFERENCES RR_Employee (EMPLOYEE_ID),
    RENT_CUSTOMER_ID        NUMBER(4)      REFERENCES RR_Customer (CUST_ID),
    BIKE_ID                 NUMBER(4)      REFERENCES RR_Bike (BIKE_ID),
    RENTAL_DATE             DATE            NOT NULL,
    RENTAL_TIME             VARCHAR(9)     NOT NULL,
    RENTAL_PRICE            NUMBER(10,2)     NOT NULL,
    RETURN_DUE              DATE            NOT NULL,
    RETURN_DATE             DATE
    /* Created by Nathan */
);
CREATE TABLE RR_Order
(
    ORDER_ID           NUMBER(4)      PRIMARY KEY,
    EMPLOYEE_ID        NUMBER(4)      references RR_Employee(EMPLOYEE_ID),
    ORDER_DATE         DATE           NOT NULL,
    ORDER_TIME         VARCHAR(9)     NOT NULL
/* Made  by Oliver Bevington */
);
CREATE TABLE RR_ORDER_PARTS
(
    LNK_ORDER_ID          NUMBER(4)       references RR_Order(ORDER_ID),
    LNK_ORDER_PART_ID     NUMBER(4)       references RR_Parts(PART_ID),
    PRIMARY KEY (LNK_ORDER_ID,LNK_ORDER_PART_ID)
/*Made by Oliver Bevington*/
);
CREATE TABLE RR_MAINTENANCE
(
    MAINTENANCE_ID          NUMBER(4)      PRIMARY KEY,
    BIKE_ID                 NUMBER(4)      references RR_Bike(BIKE_ID),
    PART_ID                 NUMBER(4)      references RR_Parts(PART_ID),
    EMPLOYEE_ID             NUMBER(4)      references RR_Employee(EMPLOYEE_ID),
    BIKE_FAULT              VARCHAR(15)     NOT NULL,
    FAULT_DATE              DATE            NOT NULL,
    BIKE_FIXED              VARCHAR(3),      
    SERVICE_DESCRIPTION     VARCHAR(40), 
    FIX_DATE                DATE,
    SERVICE_DATE            DATE,
    SERVICE_COST            NUMBER(10,2)      NOT NULL,
    CONSTRAINT CHK_BIKE_FIXED CHECK (BIKE_FIXED = 'YES' OR BIKE_FIXED = 'NO')
    
/*Made by Nathan Ainsley */
);
CREATE TABLE RR_PARTS_MAINTENANCE
(
    LNK_MAINTENANCE_ID  NUMBER(4)      references RR_Manufacturer(MANUFACTURER_ID),
    LNK_PART_ID         NUMBER(4)      references RR_Parts(PART_ID),
    PRIMARY KEY(LNK_MAINTENANCE_ID,LNK_PART_ID)
    /* Made by James Brito Alvarado */
);
 
 
 
 



/*DATA INSERT SECTION*/

/*CUSTOMER*/

INSERT INTO RR_Customer(CUST_ID,CUST_FNAME,CUST_LNAME,CUST_ADDRESS,CUST_POSTCODE,CUST_PHONE,CUST_EMAIL)
VALUES(0001,'Joe','Davies','39 Primrose Lane','yo12 7ee',07895135783,'joejdav99@gmail.com');
INSERT INTO RR_CUSTOMER(CUST_ID,CUST_FNAME,CUST_LNAME,CUST_ADDRESS,CUST_POSTCODE,CUST_PHONE,CUST_EMAIL)
VALUES(0002,'Kathy','Sloan','565 King Street','bg54 8fr',07245698266,'kathsloan@myemail.com');
INSERT INTO RR_CUSTOMER(CUST_ID,CUST_FNAME,CUST_LNAME,CUST_ADDRESS,CUST_POSTCODE,CUST_PHONE,CUST_EMAIL)
VALUES(0003,'James','Brewer','45 Latham Avenue','gh64 0hj',07538269406,'jamie.85@hotmail.com');

/*EMPLOYEE*/

INSERT INTO RR_Employee(EMPLOYEE_ID,EMP_FORENAME,EMP_SURNAME,EMP_ADDRESS,EMP_POSTCODE,EMP_PHONE,EMP_EMAIL)
VALUES(0001,'Jack','Black','76 Heart Road','sh99 2gn',07455890901,'Jack@hotmail.com');
INSERT INTO RR_Employee(EMPLOYEE_ID,EMP_FORENAME,EMP_SURNAME,EMP_ADDRESS,EMP_POSTCODE,EMP_PHONE,EMP_EMAIL)
VALUES(0002,'William','Davies','44 Grim Street','fg56 2gg',07676743590,'okay@gmail.com');
INSERT INTO RR_Employee(EMPLOYEE_ID,EMP_FORENAME,EMP_SURNAME,EMP_ADDRESS,EMP_POSTCODE,EMP_PHONE,EMP_EMAIL)
VALUES(0003,'Ellie','Cook','1 Cook Street','ja76 9hg',07895135783,'runninfnames@hotmail.com');

/*BUYER*/

INSERT INTO RR_BUYER(BUYER_ID,BUYER_NAME,BUYER_ADDRESS,BUYER_POSTCODE,BUYER_PHONE)
VALUES(0001,'Jasmine Cook','56 Kingsley Road','kj67 9ll',07657613290);
INSERT INTO RR_BUYER(BUYER_ID,BUYER_NAME,BUYER_ADDRESS,BUYER_POSTCODE,BUYER_PHONE)
VALUES(0002,'Sophie Jones','12 Maguire Street','gj22 7uu',076574617834);
INSERT INTO RR_BUYER(BUYER_ID,BUYER_NAME,BUYER_ADDRESS,BUYER_POSTCODE,BUYER_PHONE)
VALUES(0003,'Jack Whitehead','23 Primrose Lane','hj43 2ba',07567891320);


/*MANUFACTURER*/

INSERT INTO RR_MANUFACTURER(MANUFACTURER_ID,MANUFACTURER_NAME,MANUFACTURER_ADDRESS,MANUFACTURER_POSTCODE,MANUFACTURER_PHONE)
VALUES(0001,'Jonathan Jones','19 Hillview Road','wa67 0hh',07134894358);
INSERT INTO RR_Manufacturer(MANUFACTURER_ID,MANUFACTURER_NAME,MANUFACTURER_ADDRESS,MANUFACTURER_POSTCODE,MANUFACTURER_PHONE)
VALUES(0002,'Alex Usher','12 Boy Road','fg91 5oj',07472573890);
INSERT INTO RR_MANUFACTURER(MANUFACTURER_ID,MANUFACTURER_NAME,MANUFACTURER_ADDRESS,MANUFACTURER_POSTCODE,MANUFACTURER_PHONE)
VALUES(0003,'Michelle Green','67 Bored Lane','dp73 4un',07556989231);

/*BIKE*/

--INSERT INTO RR_Bike(BIKE_ID,    BK_MANUFACTURER_ID,    BIKE_MODEL,  BIKE_SIZE,    BIKE_BOUGHT_PRICE,    BIKE_BOUGHT_DATE,   SALE_PRICE,     BIKE_AVAILABILITY,      BK_BUYER_ID,        SALE_DATE),
INSERT INTO RR_Bike VALUES(0001,0001,'BLACK','SMALL','299.99',TO_DATE('2004/04/12','yyyy/mm/dd'),'199.99','YES',0002,TO_DATE('2005/09/09','yyyy/mm/dd'));
INSERT INTO RR_Bike VALUES(0002,0003,'ORANGE','LARGE','249.99',TO_DATE('2007/03/11','yyyy/mm/dd'),'210.99','NO',0001,TO_DATE('2004/08/11','yyyy/mm/dd'));
INSERT INTO RR_Bike VALUES(0003,0001,'ORANGE','MEDIUM','289.99',TO_DATE('2008/02/12','yyyy/mm/dd'),'200.01','YES',0003,TO_DATE('2002/04/12','yyyy/mm/dd'));

/*PARTS*/

INSERT INTO RR_PARTS VALUES(0001,'SEAT','SMALL',0002,'30');
INSERT INTO RR_PARTS VALUES(0002,'GEAR','LARGE',0001,'70');
INSERT INTO RR_PARTS VALUES(0003,'CHAIN','MEDIUM',0003,'35');

/*MAINTENANCE*/

--MAINTENANCE_ID    BIKE_ID    PART_ID     EMPLOYEE_ID   BIKE_FAULT    FAULT_DATE    BIKE_FIXED  SERVICE_DESCRIPTION  FIX_DATE  SERVICE_DATE  SERVICE_COST
INSERT INTO RR_MAINTENANCE VALUES(0001,0002,0003,0001,'Broken chain', TO_DATE('2004/09/12','yyyy/mm/dd'),'YES','Full service given',TO_DATE('2004/09/18','yyyy/mm/dd'),TO_DATE('2004/09/19','yyyy/mm/dd'),'75');
INSERT INTO RR_MAINTENANCE VALUES(0002,0003,0002,0001,'Deflated tires', TO_DATE('2008/06/12','yyyy/mm/dd'),'YES','',TO_DATE('2008/06/16','yyyy/mm/dd'),TO_DATE('2008/06/17','yyyy/mm/dd'),'67');
INSERT INTO RR_MAINTENANCE VALUES(0003,0001,0001,0002,'Broken chain', TO_DATE('2002/05/12','yyyy/mm/dd'),'YES','bike cleaned',TO_DATE('2002/05/12','yyyy/mm/dd'),TO_DATE('2002/05/13','yyyy/mm/dd'),'32');

/*PARTS MAINTENANCE*/

INSERT INTO RR_PARTS_MAINTENANCE VALUES(0001,0003);
INSERT INTO RR_PARTS_MAINTENANCE VALUES(0002,0002);
INSERT INTO RR_PARTS_MAINTENANCE VALUES(0003,0001);

/*RENTAL*/

INSERT INTO RR_RENTAL VALUES(0001,0001,0002,0003,TO_DATE('2004/09/12','yyyy/mm/dd'),TO_DATE('13:39:01','HH24/MI/SS'),15.99,TO_DATE('2004/09/17','yyyy/mm/dd'),TO_DATE('2004/09/18','yyyy/mm/dd'));
INSERT INTO RR_RENTAL VALUES(0002,0001,0001,0001,TO_DATE('2006/06/02','yyyy/mm/dd'),TO_DATE('22:54:45','HH24/MI/SS'),18.99,TO_DATE('2006/06/12','yyyy/mm/dd'),TO_DATE('2006/06/10','yyyy/mm/dd'));
INSERT INTO RR_RENTAL VALUES(0003,0003,0003,0002,TO_DATE('2010/03/23','yyyy/mm/dd'),TO_DATE('07:12:03','HH24/MI/SS'),12.99,TO_DATE('2010/03/27','yyyy/mm/dd'),TO_DATE('2010/03/27','yyyy/mm/dd'));

/*ORDER*/

INSERT INTO RR_Order VALUES(0001,0001,TO_DATE('2004/09/12','yyyy/mm/dd'),TO_DATE('13:39:01','HH24/MI/SS'));
INSERT INTO RR_Order VALUES(0002,0003,TO_DATE('2007/11/08','yyyy/mm/dd'),TO_DATE('22:54:45','HH24/MI/SS'));
INSERT INTO RR_Order VALUES(0003,0002,TO_DATE('2012/04/17','yyyy/mm/dd'),TO_DATE('07:12:03','HH24/MI/SS'));

/*ORDER PARTS*/

INSERT INTO RR_ORDER_PARTS VALUES(0001,0003);
INSERT INTO RR_ORDER_PARTS VALUES(0002,0001);
INSERT INTO RR_ORDER_PARTS VALUES(0003,0002);


set verify off
SELECT RR_Bike.BIKE_ID, RR_Bike.BIKE_MODEL, RR_Bike.BIKE_SIZE,RR_Bike.SALE_PRICE ,RR_MAINTENANCE.SERVICE_DATE, RR_MAINTENANCE.SERVICE_DESCRIPTION 
FROM RR_Bike, RR_MAINTENANCE
WHERE RR_BIKE.BIKE_ID = RR_MAINTENANCE.BIKE_ID
    AND BIKE_AVAILABILITY='YES'
    AND BIKE_SIZE LIKE '%'||'&Enter_Size_of_Bike_S_M_L'||'%'
Order by RR_Bike.BIKE_MODEL;
set verify on
/* Created By Nathan*/



SELECT 
    BIKE_ID,
    MAINTENANCE_ID,
    MAX(SERVICE_DATE) AS "LAST_SERVICED",
    SERVICE_DESCRIPTION,
    SERVICE_COST AS "COST_OF_LAST_SERVICE"
FROM  RR_MAINTENANCE
GROUP BY BIKE_ID,MAINTENANCE_ID,SERVICE_DESCRIPTION,SERVICE_COST;
/* Created by Nathan */

SELECT 
    RR_RENTAL.RENTAL_ID, 
    RR_Customer.CUST_ID, 
    CONCAT(RR_Customer.CUST_FNAME,RR_Customer.CUST_LNAME) AS CUSTOMER_NAME,
    RR_Customer.CUST_PHONE,
    RR_Customer.CUST_EMAIL,
    RR_EMPLOYEE.EMPLOYEE_ID,
    CONCAT(RR_EMPLOYEE.EMP_FORENAME,RR_EMPLOYEE.EMP_SURNAME) AS EMPLOYEE_NAME
FROM RR_RENTAL,RR_Customer,RR_EMPLOYEE
    WHERE RETURN_DUE >= TO_DATE(SYSDATE, 'DD/MM/YYYY')
    AND RR_Customer.CUST_ID = RR_RENTAL.RENT_CUSTOMER_ID
    AND RR_RENTAL.RENT_CUSTOMER_ID=RR_EMPLOYEE.EMPLOYEE_ID;
/*Created by Joe*/

SELECT
    BIKE_ID,
    BIKE_BOUGHT_PRICE,
    SALE_PRICE,
    (BIKE_BOUGHT_PRICE-SALE_PRICE) AS VALUE_LOST
FROM RR_Bike;
/*Created By James*/






 
 
 
 